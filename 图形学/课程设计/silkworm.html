<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>多变的虫虫</title>
    </head>
    <body>
        <!-- three包 -->
        <script type="text/javascript" src='lib/Three.js'></script>
        <script type="text/javascript" src='lib/Controls.js-master/TrackballControls.js'></script>
        <script type="text/javascript" src='lib/stats.min.js'></script>
        <script type="text/javascript" src='lib/dat.gui.min.js'></script>

        <!-- 初始化 -->
        <script type="text/javascript" src='silkworm/init/initStats.js'></script>
        <script type="text/javascript" src='silkworm/init/initScene.js'></script>
        <script type="text/javascript" src='silkworm/init/initCamera.js'></script>
        <script type="text/javascript" src='silkworm/init/initRenderer.js'></script>
        <script type="text/javascript" src='silkworm/init/initPlane.js'></script>
        <script type="text/javascript" src='silkworm/init/initLight.js'></script>
        <script type="text/javascript" src='silkworm/init/initSilkwarm.js'></script>
        <script type="text/javascript" src='silkworm/init/initTrackballControls.js'></script>
        <script type="text/javascript" src='silkworm/init/init.js'></script>
        <!-- 动画 -->
        <script type="text/javascript" src='silkworm/anim/animJump.js'></script>
        <script type="text/javascript" src='silkworm/anim/ArrowHelper.js'></script>
        <script type="text/javascript" src='silkworm/anim/showRotation.js'></script>
        <script type="text/javascript" src='silkworm/anim/AddLight.js'></script>
        <!-- gui -->
        <script type="text/javascript" src='silkworm/gui/controls.js'></script>


        <script type="text/javascript">

            // 根据相机camera的距离差距来改变物体的清晰程度
            // scene.overrideMaterial = new THREE.MeshDepthMaterial();
            addGUI();//gui
            init();

            function render(){
                stats.update();

                if(controls.animjump == false && controls.showrotation == false){
                    initSilkwarm(controls.eyecolor, controls.bodycolor1, controls.bodycolor2, controls.eyewireframe, controls.bodywireframe1, controls.bodywireframe2 ,controls.size); // 绘制虫子 // 放在render里可根据gui改变颜色
                }// 在不动的时候改变颜色

                if(controls.animjump) animJump();//控制跳动

                if(controls.plane == true) initPlane(controls.planecolor, controls.planeangle);// 放在render里可根据gui改变颜色
                else {
                    if(plane instanceof THREE.Mesh)
                        scene.remove(plane);
                }

                if(controls.showrotation == true) showRotation();// 进行旋转展示 
                    
                if(controls.showarrowhelper) showArrowHelper();//展示旋转轴

                if(controls.spotlight) MoveSpotlight();
                
                // addTrackball();//轨迹球控件，加了之后就不能改变颜色时，可以滑动不能确定
                requestAnimationFrame(render);
                renderer.render(scene, camera);
                
            }
            // window.requestAnimationFrame(this.render.bind(this));
            render();
            document.body.appendChild(renderer.domElement);

        </script>
    </body>
</html>